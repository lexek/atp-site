<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <title>ATPlay.ch</title>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no"/>

    <link rel='stylesheet' href='http://fonts.googleapis.com/css?family=Roboto:400,500,700,400italic'>
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/static/assets/app.css"/>

    <style type="text/css">
        [ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak {
            display: none !important;
        }
    </style>
</head>

{%verbatim%}
<body ng-app="starterApp" layout="column" ng-controller="ChannelController as c" ng-cloak layout-fill>
<md-toolbar flex="none" class="" md-theme="dark" id="toolbar">
    <div class="md-toolbar-tools" layout="row">
        <div flex="none" style="width: 108px; height: 64px; margin-top: 10px; background-image: url('../static/assets/logo.png')"></div>
        <div flex="none" layout="row" player-inner toolbar-w>
            <div flex layout="column">
                <div class="md-title" flex="70">
                    <md-menu>
                        <md-button class="md-button" aria-label="channel" flex="none" ng-click="$mdOpenMenu($event)" ng-class="{'online': c.selectedPlayer.online}">
                            <md-icon md-svg-icon="{{ c.selectedPlayer.provider }}"></md-icon>
                            <md-badge ng-if="c.selectedPlayer.online" style="margin-right: 5px; vertical-align: middle;">LIVE</md-badge>
                            <span class="stream-title">{{ c.channel.status }}</span>
                        </md-button>
                        <md-menu-content layout="column" md-theme="deep-purple">
                            <md-menu-item ng-repeat="player in c.players | orderBy:'player.id' track by player.id " flex="grow" md-autofocus="player.id === c.selectedPlayer.id">
                                <md-button ng-click="c.selectChannel(player)">
                                    <md-badge ng-if="player.online" style="float: right;">LIVE</md-badge>
                                    <md-icon md-svg-icon="{{ player.provider }}"></md-icon>
                                    {{ player.provider }}
                                </md-button>
                            </md-menu-item>
                        </md-menu-content>
                    </md-menu>
                </div>
                <div class="md-caption" flex="30" style="padding: 0 14px">
                    <span ng-if="!c.anyOnline()">
                        нострим
                    </span>
                    <span ng-if="c.anyOnline()">
                        {{ c.channel.streamer || "Некий стример" }} стримит
                        {{ c.channel.game || "что-то" }} и его смотрит
                        {{ c.channel.viewers }} человек
                    </span>
                </div>
            </div>
        </div>
        <div flex="grow" layout="row">
            <div layout-fill layout="row">
                <div flex="none">
                    <md-button class="md-icon-button" href="https://www.youtube.com/user/ATPGAMESCHANNEL" aria="Youtube" target="_blank">
                        <md-tooltip>Канал на YouTube</md-tooltip>
                        <md-icon md-svg-icon="youtube"></md-icon>
                    </md-button>
                    <md-button class="md-icon-button" href="https://twitter.com/atPlay_channel" aria="Twitter" target="_blank">
                        <md-tooltip>Twitter</md-tooltip>
                        <md-icon md-svg-icon="twitter"></md-icon>
                    </md-button>
                    <md-button class="md-icon-button" href="https://telegram.me/atplay" aria="Telegram" target="_blank">
                        <md-tooltip>Канал в Telegram</md-tooltip>
                        <md-icon md-svg-icon="telegram"></md-icon>
                    </md-button>
                    <md-button class="md-icon-button" href="https://vk.com/atplay" aria="Vk" target="_blank">
                        <md-tooltip>Группа ВКонтакте</md-tooltip>
                        <md-icon md-svg-icon="vk"></md-icon>
                    </md-button>
                </div>
                <span flex="grow"></span>
                <md-button flex="none" class="md-icon-button" ng-click="c.subscribe()" ng-if="!c.subscribed">
                    <md-tooltip>Подписаться на уведомления</md-tooltip>
                    <md-icon md-svg-icon="notifications-none" style="fill: white"></md-icon>
                </md-button>
                <md-button flex="none" class="md-icon-button" ng-if="c.subscribed">
                    <md-tooltip>Уведомления включены</md-tooltip>
                    <md-icon md-svg-icon="notifications" style="fill: white"></md-icon>
                </md-button>
                <md-button flex="none" class="md-icon-button" aria="Donate" href="https://twitch.streamlabs.com/ATPChannel" target="_blank">
                    <md-tooltip>Пожертвования</md-tooltip>
                    <md-icon md-svg-icon="money" style="fill: rgba(255, 255, 255, 0.87);"></md-icon>
                </md-button>
                <md-button flex="none" class="md-icon-button" ng-click="c.chatPopup()">
                    <md-tooltip>Открыть чат в отдельном окне</md-tooltip>
                    <md-icon md-svg-icon="chat" style="fill: rgba(255, 255, 255, 0.87);"></md-icon>
                </md-button>
            </div>
        </div>
    </div>
</md-toolbar>

<div id="content" layout="row" flex="grow" layout-align="space-between">
    <div
        flex="none"
        ng-controller="PlayerController as p"
        layout="column"
        layout-align="center"
        layout-margin
        style="background: rgba(0, 0, 0, 0.2); border-radius: 5px;"
    >
        <div
            flex="none"
            class="md-whiteframe-10dp"
            player-inner
            style="margin: 0"
        >
            <div
                flex="none"
                ng-include="'/static/channels/view/' + c.selectedPlayer.provider + '.html'"
                style="overflow: hidden; background-color: black;"
                class="md-whiteframe-10dp"
                layout-fill
                ></div>
        </div>
    </div>
    <div flex="grow" style="min-width:400px" layout="column" layout-margin class="md-whiteframe-10dp">
        <iframe layout-fill flex="grow" frameborder="0" scrolling="no" id="chat_embed"
                src="https://atplay.ch:1337/chat.html"></iframe>
    </div>
</div>


<script>
var _rollbarConfig = {
    accessToken: "67eea5f5b173433e9550dbf6928c72fd",
    captureUncaught: true,
    captureUnhandledRejections: false,
    payload: {
        environment: "production"
    }
};
// Rollbar Snippet
!function(r){function e(t){if(o[t])return o[t].exports;var n=o[t]={exports:{},id:t,loaded:!1};return r[t].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var o={};return e.m=r,e.c=o,e.p="",e(0)}([function(r,e,o){"use strict";var t=o(1).Rollbar,n=o(2);_rollbarConfig.rollbarJsUrl=_rollbarConfig.rollbarJsUrl||"https://d37gvrvc0wt4s1.cloudfront.net/js/v1.9/rollbar.min.js";var a=t.init(window,_rollbarConfig),i=n(a,_rollbarConfig);a.loadFull(window,document,!_rollbarConfig.async,_rollbarConfig,i)},function(r,e){"use strict";function o(r){return function(){try{return r.apply(this,arguments)}catch(e){try{console.error("[Rollbar]: Internal error",e)}catch(o){}}}}function t(r,e,o){window._rollbarWrappedError&&(o[4]||(o[4]=window._rollbarWrappedError),o[5]||(o[5]=window._rollbarWrappedError._rollbarContext),window._rollbarWrappedError=null),r.uncaughtError.apply(r,o),e&&e.apply(window,o)}function n(r){var e=function(){var e=Array.prototype.slice.call(arguments,0);t(r,r._rollbarOldOnError,e)};return e.belongsToShim=!0,e}function a(r){this.shimId=++c,this.notifier=null,this.parentShim=r,this._rollbarOldOnError=null}function i(r){var e=a;return o(function(){if(this.notifier)return this.notifier[r].apply(this.notifier,arguments);var o=this,t="scope"===r;t&&(o=new e(this));var n=Array.prototype.slice.call(arguments,0),a={shim:o,method:r,args:n,ts:new Date};return window._rollbarShimQueue.push(a),t?o:void 0})}function l(r,e){if(e.hasOwnProperty&&e.hasOwnProperty("addEventListener")){var o=e.addEventListener;e.addEventListener=function(e,t,n){o.call(this,e,r.wrap(t),n)};var t=e.removeEventListener;e.removeEventListener=function(r,e,o){t.call(this,r,e&&e._wrapped?e._wrapped:e,o)}}}var c=0;a.init=function(r,e){var t=e.globalAlias||"Rollbar";if("object"==typeof r[t])return r[t];r._rollbarShimQueue=[],r._rollbarWrappedError=null,e=e||{};var i=new a;return o(function(){if(i.configure(e),e.captureUncaught){i._rollbarOldOnError=r.onerror,r.onerror=n(i);var o,a,c="EventTarget,Window,Node,ApplicationCache,AudioTrackList,ChannelMergerNode,CryptoOperation,EventSource,FileReader,HTMLUnknownElement,IDBDatabase,IDBRequest,IDBTransaction,KeyOperation,MediaController,MessagePort,ModalWindow,Notification,SVGElementInstance,Screen,TextTrack,TextTrackCue,TextTrackList,WebSocket,WebSocketWorker,Worker,XMLHttpRequest,XMLHttpRequestEventTarget,XMLHttpRequestUpload".split(",");for(o=0;o<c.length;++o)a=c[o],r[a]&&r[a].prototype&&l(i,r[a].prototype)}return e.captureUnhandledRejections&&(i._unhandledRejectionHandler=function(r){var e=r.reason,o=r.promise,t=r.detail;!e&&t&&(e=t.reason,o=t.promise),i.unhandledRejection(e,o)},r.addEventListener("unhandledrejection",i._unhandledRejectionHandler)),r[t]=i,i})()},a.prototype.loadFull=function(r,e,t,n,a){var i=function(){var e;if(void 0===r._rollbarPayloadQueue){var o,t,n,i;for(e=new Error("rollbar.js did not load");o=r._rollbarShimQueue.shift();)for(n=o.args,i=0;i<n.length;++i)if(t=n[i],"function"==typeof t){t(e);break}}"function"==typeof a&&a(e)},l=!1,c=e.createElement("script"),d=e.getElementsByTagName("script")[0],p=d.parentNode;c.crossOrigin="",c.src=n.rollbarJsUrl,c.async=!t,c.onload=c.onreadystatechange=o(function(){if(!(l||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)){c.onload=c.onreadystatechange=null;try{p.removeChild(c)}catch(r){}l=!0,i()}}),p.insertBefore(c,d)},a.prototype.wrap=function(r,e){try{var o;if(o="function"==typeof e?e:function(){return e||{}},"function"!=typeof r)return r;if(r._isWrap)return r;if(!r._wrapped){r._wrapped=function(){try{return r.apply(this,arguments)}catch(e){throw e._rollbarContext=o()||{},e._rollbarContext._wrappedSource=r.toString(),window._rollbarWrappedError=e,e}},r._wrapped._isWrap=!0;for(var t in r)r.hasOwnProperty(t)&&(r._wrapped[t]=r[t])}return r._wrapped}catch(n){return r}};for(var d="log,debug,info,warn,warning,error,critical,global,configure,scope,uncaughtError,unhandledRejection".split(","),p=0;p<d.length;++p)a.prototype[d[p]]=i(d[p]);r.exports={Rollbar:a,_rollbarWindowOnError:t}},function(r,e){"use strict";r.exports=function(r,e){return function(o){if(!o&&!window._rollbarInitialized){var t=window.RollbarNotifier,n=e||{},a=n.globalAlias||"Rollbar",i=window.Rollbar.init(n,r);i._processShimQueue(window._rollbarShimQueue||[]),window[a]=i,window._rollbarInitialized=!0,t.processPayloads()}}}}]);
// End Rollbar Snippet
</script>

<script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js"></script>
<script>
var OneSignal = window.OneSignal || [];
OneSignal.push(["init", {
    appId: "e15c72d0-da39-48f9-88b9-b95bfad38a66",
    autoRegister: false,
    subdomainName: 'lexek-localhost',
    httpPermissionRequest: {
        enable: true
    },
    notifyButton: {
      enable: false
    }//,
    //persistNotification: false
}]);
</script>

<script src="//code.jquery.com/jquery-2.2.4.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-animate.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-aria.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-messages.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.js"></script>

<script src="/static/channels/Channels.js"></script>
<script src="/static/channels/ChannelController.js"></script>
<script src="/static/channels/ChannelService.js"></script>
<script src="/static/channels/PlayerDirective.js"></script>

<script type="text/javascript">
    angular
        .module('starterApp', ['ngMaterial', 'channels'])
        .config(function ($mdThemingProvider, $mdIconProvider, $sceDelegateProvider) {
            $mdIconProvider
                .icon("twitch", "/static/assets/svg/twitch.svg", 1140)
                .icon("cybergame", "/static/assets/svg/cybergame.svg", 85)
                .icon("ustream", "/static/assets/svg/ustream.svg", 682)
                .icon("youtube", "/static/assets/svg/youtube.svg", 128)
                .icon("vk", "/static/assets/svg/vk.svg", 980)
                .icon("twitter", "/static/assets/svg/twitter.svg", 512)
                .icon("telegram", "/static/assets/svg/telegram.svg", 512)
                .icon("chat", "/static/assets/svg/chat.svg", 48)
                .icon("goodgame", "/static/assets/svg/goodgame.svg", 170)
                .icon("money", "/static/assets/svg/money.svg", 48)
                .icon("notifications", "/static/assets/svg/notifications.svg", 24)
                .icon("notifications-none", "/static/assets/svg/notifications_none.svg", 24);

            $mdThemingProvider.definePalette('dark', {
                "50": "#c1c5da",
                "100": "#9198be",
                "200": "#6d77a9",
                "300": "#4d5583",
                "400": "#41496f",
                "500": "#363c5c",
                "600": "#2b2f49",
                "700": "#1f2335",
                "800": "#ffffff",
                "900": "#ffffff",
                "A100": "#c1c5da",
                "A200": "#9198be",
                "A400": "#41496f",
                "A700": "#1f2335"
            });

            $mdThemingProvider.theme('dark')
             .primaryPalette('dark');

            $sceDelegateProvider.resourceUrlWhitelist([
                'self',
                'http://api.cybergame.tv/**',
                "http://www.twitch.tv/**",
                "http://player.twitch.tv/**",
                "http://www.ustream.tv/embed/**",
                "http://goodgame.ru/nocache/ggplayer/**"
            ]);
        });
</script>

</body>
{%endverbatim%}
</html>
